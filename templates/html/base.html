<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="{{ description | default: 'Fort Homes Quality Management System Documentation' }}">
  <meta name="author" content="Fort Homes LLC">
  
  <title>{{ title | default: 'Fort Homes QMS Documentation' }}</title>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="{{ base_path | default: '../..' }}/assets/css/main.css">
  <link rel="stylesheet" href="{{ base_path | default: '../..' }}/assets/css/typography.css">
  <link rel="stylesheet" href="{{ base_path | default: '../..' }}/assets/css/tables.css">
  <link rel="stylesheet" href="{{ base_path | default: '../..' }}/assets/css/forms.css">
  <link rel="stylesheet" href="{{ base_path | default: '../..' }}/assets/css/diagrams.css">
  <link rel="stylesheet" href="{{ base_path | default: '../..' }}/assets/css/print.css" media="print">
  
  <!-- Custom styles -->
  {% if custom_css %}
  <style>
    {{ custom_css }}
  </style>
  {% endif %}
</head>
<body>
  
  <!-- Document Header -->
  <header class="document-header">
    <div class="document-header-left">
      üèóÔ∏è FORT HOMES
    </div>
    <div class="document-header-center">
      QUALITY MANAGEMENT SYSTEM
    </div>
    <div class="document-header-right">
      {{ document_id | default: 'FHDEV-QMS' }}
    </div>
  </header>
  
  <!-- Document Wrapper -->
  <div class="document-wrapper">
    
    <!-- Document Title -->
    {% if document_title %}
    <h1 class="document-title">{{ document_title }}</h1>
    {% endif %}
    
    <!-- Document Control Block -->
    {% if show_document_control %}
    <div class="document-control">
      <h2>Document Control</h2>
      <table class="metadata-table">
        <tbody>
          <tr>
            <th>Document ID</th>
            <td class="document-id">{{ document_id | default: 'FHDEV-QMS-XXX' }}</td>
          </tr>
          <tr>
            <th>Revision</th>
            <td class="revision-number">{{ revision | default: '1.0' }}</td>
          </tr>
          <tr>
            <th>Effective Date</th>
            <td class="document-date">{{ effective_date | default: 'January 2026' }}</td>
          </tr>
          <tr>
            <th>Process Owner</th>
            <td class="responsible-party">{{ process_owner | default: 'Quality Manager' }}</td>
          </tr>
          <tr>
            <th>Next Review</th>
            <td class="document-date">{{ next_review | default: 'July 2026' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    {% endif %}
    
    <!-- Table of Contents -->
    {% if show_toc %}
    <nav class="toc" role="navigation">
      <h2>Table of Contents</h2>
      {{ toc }}
    </nav>
    {% endif %}
    
    <!-- Main Content -->
    <main class="document-content">
      {{ content }}
    </main>
    
    <!-- Revision History -->
    {% if show_revision_history %}
    <section class="revision-history">
      <h2>Revision History</h2>
      <table class="revision-history">
        <thead>
          <tr>
            <th>Rev</th>
            <th>Date</th>
            <th>Author</th>
            <th>Approver</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          {% for revision in revisions %}
          <tr>
            <td>{{ revision.version }}</td>
            <td class="date-cell">{{ revision.date }}</td>
            <td>{{ revision.author }}</td>
            <td>{{ revision.approver }}</td>
            <td>{{ revision.description }}</td>
          </tr>
          {% endfor %}
          {% if revisions.size == 0 %}
          <tr>
            <td>1.0</td>
            <td class="date-cell">{{ effective_date | default: '2026-01-15' }}</td>
            <td>{{ author | default: 'Quality Manager' }}</td>
            <td>{{ approver | default: 'President' }}</td>
            <td>Initial release</td>
          </tr>
          {% endif %}
        </tbody>
      </table>
    </section>
    {% endif %}
    
    <!-- Approval Block -->
    {% if show_approval %}
    <section class="approval-block mt-xl">
      <h2>Approval & Authority</h2>
      <table class="approval-table">
        <thead>
          <tr>
            <th>Role</th>
            <th>Name</th>
            <th>Signature</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Prepared By</td>
            <td>{{ prepared_by | default: 'Quality Manager' }}</td>
            <td class="signature-cell"></td>
            <td class="date-cell"></td>
          </tr>
          <tr>
            <td>Reviewed By</td>
            <td>{{ reviewed_by | default: 'Operations Manager' }}</td>
            <td class="signature-cell"></td>
            <td class="date-cell"></td>
          </tr>
          <tr>
            <td>Approved By</td>
            <td>{{ approved_by | default: 'President' }}</td>
            <td class="signature-cell"></td>
            <td class="date-cell"></td>
          </tr>
        </tbody>
      </table>
    </section>
    {% endif %}
    
  </div>
  
  <!-- Document Footer -->
  <footer class="document-footer">
    <div class="document-footer-line1">
      {{ document_id | default: 'FHDEV-QMS-XXX' }} | 
      Rev {{ revision | default: '1.0' }} | 
      Page <span class="page-number"></span> of <span class="page-count"></span> | 
      Eff: {{ effective_date | default: 'January 2026' }}
    </div>
    <div class="document-footer-line2">
      ‚ö† UNCONTROLLED WHEN PRINTED - Verify current revision
    </div>
  </footer>
  
  <!-- Scripts -->
  {% if include_scripts %}
  <script>
    // Page numbering (for print)
    function updatePageNumbers() {
      const pageNumbers = document.querySelectorAll('.page-number');
      const pageCounts = document.querySelectorAll('.page-count');
      
      pageNumbers.forEach(el => el.textContent = '1');
      pageCounts.forEach(el => el.textContent = '1');
    }
    
    // Enhance tables for mobile
    function enhanceTablesForMobile() {
      const tables = document.querySelectorAll('table');
      
      tables.forEach(table => {
        const headers = Array.from(table.querySelectorAll('th')).map(th => th.textContent);
        const rows = table.querySelectorAll('tbody tr');
        
        rows.forEach(row => {
          const cells = row.querySelectorAll('td');
          cells.forEach((cell, index) => {
            if (headers[index]) {
              cell.setAttribute('data-label', headers[index]);
            }
          });
        });
      });
    }
    
    // Initialize on load
    document.addEventListener('DOMContentLoaded', () => {
      updatePageNumbers();
      enhanceTablesForMobile();
    });
    
    // Update on print
    window.addEventListener('beforeprint', updatePageNumbers);
  </script>
  {% endif %}
  
  {{ custom_scripts }}
  
</body>
</html>
